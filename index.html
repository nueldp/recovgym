<!DOCTYPE html>
<html lang="id">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title>RecovGym Salatiga</title>
  
   <!-- PWA Meta Tags -->
   <meta name="theme-color" content="#2563eb">
   <meta name="mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
   <link rel="manifest" href="data:application/json;base64,ewogICJzaG9ydF9uYW1lIjogIlJlY292R3ltIiwKICAi2mFtZSI6ICJSZWNvdkd5bSAtIFJlY292ZXJ5IFRyYWNrZXIiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJodHRwczovL2Nkbi1pY29ucy1wbmcuZmxhdGljb24uY29tLzUxMi8yOTY0LzI5NjQ1NjMucG5nIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9CiAgXSwKICAic3RhcnRfdXJsIjogIi4iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmOGZhZmMiLAogICJ0aGVtZV9jb2xvciI6ICIjMjU2M2ViIgp9">

   <!-- Tailwind & Lucide Icons -->
   <script src="https://cdn.tailwindcss.com"></script>
   <script src="https://unpkg.com/lucide@latest"></script>
  
   <!-- React -->
   <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
   <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
   <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

   <style>
       @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
       .animate-slide-up { animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
       body { -webkit-tap-highlight-color: transparent; user-select: none; }
       .hide-scrollbar::-webkit-scrollbar { display: none; }
   </style>
</head>
<body class="bg-slate-50">
   <div id="root"></div>

   <script type="text/babel">
       const { useState, useEffect } = React;

       const RECOVERY_CONFIG = {
           'Berat': { total: 72, half: 36 },
           'Sedang': { total: 48, half: 24 },
           'Ringan': { total: 24, half: 12 }
       };

       const MUSCLES = ['Dada', 'Punggung', 'Bahu', 'Kaki', 'Triceps', 'Biceps', 'Abs'];

       function App() {
           const [tab, setTab] = useState('home');
           const [workouts, setWorkouts] = useState(() => {
               const s = localStorage.getItem('rg_workouts');
               return s ? JSON.parse(s).map(w => ({...w, endTime: new Date(w.endTime)})) : [];
           });
           const [active, setActive] = useState(() => {
               const s = localStorage.getItem('rg_active');
               return s ? JSON.parse(s) : null;
           });
           const [selected, setSelected] = useState(null);
           const [showIntensity, setShowIntensity] = useState(false);

           useEffect(() => {
               localStorage.setItem('rg_workouts', JSON.stringify(workouts));
               localStorage.setItem('rg_active', JSON.stringify(active));
           }, [workouts, active]);

           const getStatus = (m) => {
               const last = workouts.filter(w => w.muscle === m).sort((a,b) => b.endTime - a.endTime)[0];
               if (!last) return { label: 'Optimal', color: 'text-green-500', dot: 'bg-green-500', h: null };
               const hrs = (new Date() - last.endTime) / 3600000;
               const cfg = RECOVERY_CONFIG[last.intensity];
               if (hrs < cfg.half) return { label: 'Recovery', color: 'text-red-500', dot: 'bg-red-500', h: Math.floor(hrs) };
               if (hrs < cfg.total) return { label: 'Hampir Siap', color: 'text-yellow-600', dot: 'bg-yellow-500', h: Math.floor(hrs) };
               return { label: 'Optimal', color: 'text-green-500', dot: 'bg-green-500', h: Math.floor(hrs) };
           };

           const finishWorkout = (intensity) => {
               const newWorkouts = active.muscles.map(m => ({
                   id: Math.random(),
                   muscle: m,
                   endTime: new Date(),
                   intensity
               }));
               setWorkouts([...workouts, ...newWorkouts]);
               setActive(null);
               setShowIntensity(false);
           };

           return (
               <div className="max-w-md mx-auto min-h-screen bg-white shadow-xl flex flex-col relative overflow-hidden">
                   {/* Header */}
                   <div className="p-6 pb-0">
                       <div className="flex justify-between items-center">
                           <h1 className="text-3xl font-black italic text-blue-600">RECOV<span className="text-slate-800">GYM</span></h1>
                           <div className="bg-blue-50 p-2 rounded-xl text-blue-600"><i data-lucide="dumbbell"></i></div>
                       </div>
                   </div>

                   {/* Content */}
                   <div className="flex-1 p-6 overflow-y-auto hide-scrollbar pb-32">
                       {tab === 'home' ? (
                           <div className="space-y-4">
                               {active && (
                                   <div className="bg-blue-600 rounded-3xl p-5 text-white shadow-lg animate-pulse">
                                       <p className="text-[10px] font-bold uppercase opacity-70">Latihan Aktif</p>
                                       <h2 className="text-xl font-bold mb-4">{active.muscles.join(' + ')}</h2>
                                       <button onClick={() => setShowIntensity(true)} className="w-full bg-white text-blue-600 py-3 rounded-2xl font-bold">Selesaikan Sesi</button>
                                   </div>
                               )}
                               <div className="grid gap-3">
                                   {MUSCLES.map(m => {
                                       const s = getStatus(m);
                                       return (
                                           <div key={m} onClick={() => setSelected(m)} className="bg-slate-50 p-5 rounded-3xl flex justify-between items-center border border-transparent active:border-blue-200 active:bg-blue-50 transition-all">
                                               <div className="flex items-center gap-4">
                                                   <div className={`w-3 h-3 rounded-full ${s.dot} shadow-sm`}></div>
                                                   <div className="text-left">
                                                       <p className="font-bold text-slate-800 text-lg">{m}</p>
                                                       <p className={`text-[10px] font-black uppercase ${s.color}`}>{s.label} {s.h !== null ? `• ${s.h} Jam Lalu` : ''}</p>
                                                   </div>
                                               </div>
                                               <div className="text-slate-300"><i data-lucide="plus"></i></div>
                                           </div>
                                       )
                                   })}
                               </div>
                           </div>
                       ) : (
                           <div className="space-y-3">
                               <h2 className="text-xl font-bold mb-4">Riwayat Sesi</h2>
                               {[...workouts].reverse().slice(0, 20).map(w => (
                                   <div key={w.id} className="bg-white border border-slate-100 p-4 rounded-2xl flex justify-between items-center">
                                       <div>
                                           <p className="font-bold">{w.muscle}</p>
                                           <p className="text-[10px] text-slate-400 font-bold uppercase">{w.intensity} • {new Date(w.endTime).toLocaleDateString()}</p>
                                       </div>
                                       <button onClick={() => setWorkouts(workouts.filter(x => x.id !== w.id))} className="text-slate-200 active:text-red-400"><i data-lucide="trash-2" size="18"></i></button>
                                   </div>
                               ))}
                           </div>
                       )}
                   </div>

                   {/* Modals */}
                   {selected && (
                       <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-end" onClick={() => setSelected(null)}>
                           <div className="bg-white w-full rounded-t-[40px] p-8 animate-slide-up" onClick={e => e.stopPropagation()}>
                               <div className="w-12 h-1 bg-slate-100 rounded-full mx-auto mb-6"></div>
                               <h3 className="text-2xl font-bold mb-6">Mulai Sesi {selected}?</h3>
                               <button onClick={() => {
                                   if (active) setActive({...active, muscles: [...new Set([...active.muscles, selected])]});
                                   else setActive({id: Date.now(), muscles: [selected]});
                                   setSelected(null);
                               }} className="w-full bg-blue-600 text-white py-5 rounded-2xl font-bold text-lg shadow-lg active:scale-95 transition-all">Konfirmasi</button>
                           </div>
                       </div>
                   )}

                   {showIntensity && (
                       <div className="fixed inset-0 bg-slate-900/80 backdrop-blur-md z-50 flex items-center p-6">
                           <div className="bg-white w-full rounded-[40px] p-8">
                               <h3 className="text-xl font-bold text-center mb-6">Seberapa berat tadi?</h3>
                               <div className="space-y-3">
                                   {['Ringan','Sedang','Berat'].map(l => (
                                       <button key={l} onClick={() => finishWorkout(l)} className="w-full p-4 rounded-2xl border-2 border-slate-50 font-bold active:bg-blue-600 active:text-white transition-all">{l}</button>
                                   ))}
                               </div>
                           </div>
                       </div>
                   )}

                   {/* Nav */}
                   <div className="absolute bottom-0 w-full bg-white/80 backdrop-blur-md border-t border-slate-100 flex justify-around py-4 pb-8">
                       <button onClick={() => setTab('home')} className={`flex flex-col items-center ${tab === 'home' ? 'text-blue-600' : 'text-slate-300'}`}>
                           <i data-lucide="home"></i>
                           <span className="text-[10px] font-bold mt-1">Status</span>
                       </button>
                       <button onClick={() => setTab('history')} className={`flex flex-col items-center ${tab === 'history' ? 'text-blue-600' : 'text-slate-300'}`}>
                           <i data-lucide="history"></i>
                           <span className="text-[10px] font-bold mt-1">Riwayat</span>
                       </button>
                   </div>
               </div>
           );
       }

       const root = ReactDOM.createRoot(document.getElementById('root'));
       root.render(<App />);
      
       // Render icons after React load
       setTimeout(() => lucide.createIcons(), 500);
   </script>
</body>
</html>
